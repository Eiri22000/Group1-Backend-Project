<main id="addDeleteEditEmployee">
    <section class="employeeFormSelection">
        <form method="post" action="/saveFormToDB">
            <fieldset class="employeeFieldset">
                <legend>
                    <h3>Uusi työntekijä</h3>
                </legend>
                <label for="employeeName" placeholder="Nimi">Työntekijän nimi: </label>
                <input id="employeeName" type="text" name="employeeName" />
                <label for="employeePhone" placeholder="Puhelinnumero">Puhelinnumero: </label>
                <input id="employeePhone" type="text" name="phoneNumber" />
                <label for="employeeEmail" placeholder='Sähköpostiosoite'>Sähköpostiosoite: </label>
                <input id="employeeEmail" type="email" name="email" />
                <label for="employeeUsername">Käyttäjälle luotu käyttäjätunnus: </label>
                <input id="employeeUsername" type="text" name="username" />
                <input type="hidden" value="addEmployee" name="type" />
                <button type="submit">Lisää työntekijä</button>
            </fieldset>
        </form>
    </section>
    <section class="employeeFormSelection">
        <form method="post" action="/updateDB">
            <fieldset id="editEmployee" class="employeeFieldset">
                 <legend>
                    <h3>Muokkaa työntekijän tietoja</h3>
                </legend>
                <label for="selectEmployee">Valitse työntekijä</label>
                <select id="selectEmployee" name="selectedEmployee">
                    {{#each workers}}
                    <option name="employeeName" data-id={{this._id}} data-name={{this.name}}
                        data-phoneNumber={{this.phoneNumber}} data-email={{this.email}}>
                        {{this.name}}</option>
                    {{/each}}
                </select>
                <label for=" editName">Työntekijän nimi: </label>
                <input id="editName" type="text" name="employeeName" value="" />
                <label for="editPhone">Puhelinnumero: </label>
                <input id="editPhone" type="text" name="phoneNumber" value="" />
                <label for="editEmail">Sähköpostiosoite: </label>
                <input id="editEmail" type="email" name="email" value="" />
                <input type="hidden" value="editEmployee" name="type" />
                <input type="hidden" id="editEmployeeHiddenInput" name="hiddenId" />
                <button type="submit">Päivitä tiedot</button>
            </fieldset>
        </form>
    </section>
    <section class="employeeFormSelection">
        <h3>Poista työntekijä</h3>
        {{#each workers}}
        <form class="deleteWorkerForm" method="post" action="/updateDB">
            <p>{{this.name}}</p>
            <button type="submit" value="{{this._id}}" name="idToRemove">Poista työntekijä</button>
            <input type="hidden" value="removeEmployee" name="type" />
        </form>
        {{/each}}
    </section>
    {{!-- <section id="lookEmployeeInfo">
        <h2>Katso työntekijän tiedot</h2>
        {{#each workers}}
        <h3>{{this.name}}</h3>
        {{/each}}
    </section> --}}

</main>
<p style="background-color:pink">TÄHÄN SE PITÄIS SAADA :{{message}}</p>

<script>
    document.getElementById("selectEmployee").addEventListener("change", function (e) {
        document.getElementById('editName').value = e.target.value
        document.getElementById('editPhone').value = e.target[e.target.options.selectedIndex].getAttribute('data-phoneNumber');
        document.getElementById('editEmail').value = e.target[e.target.options.selectedIndex].getAttribute('data-email');
        document.getElementById('editEmployeeHiddenInput').value = e.target[e.target.options.selectedIndex].getAttribute('data-id')
    })

    document.getElementById("employeeName").addEventListener("focusout", function (e) {
        let newUserName = e.target.value.toLowerCase()
        newUserName = newUserName.substring(0, 3) + newUserName.substring(newUserName.length - 3, newUserName.length) + Math.floor(Math.random() * 999)
        document.getElementById("employeeUsername").value = newUserName
    })

</script>